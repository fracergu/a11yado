---
import Layout from '../../layouts/Layout.astro'
import Card from '../../components/Card.astro'
import CardGrid from '../../components/CardGrid.astro'
import Checklist from '../../components/Checklist.astro'
import ToolsSection from '../../components/ToolsSection.astro'
import Banner from '../../components/Banner.astro'
import BannerGrid from '../../components/BannerGrid.astro'
import OrderedList from '../../components/OrderedList.astro'
import OrderedListItem from '../../components/OrderedListItem.astro'
import Header from '../../components/Header.astro'

const checklistItems = [
  '¬øLos estados hover son consistentes con los estados de foco?',
  '¬øEl contenido adicional es desechable con Escape?',
  '¬øSe puede hacer hover sobre el contenido adicional?',
  '¬øEl contenido permanece visible hasta ser desechado?',
  '¬øLos cambios visuales son independientes del color?',
  '¬øHay suficiente contraste entre estados?',
  '¬øTodos los hover tambi√©n funcionan con el teclado?',
  '¬øLos estados comunican claramente "interactivo"?',
]

const hoverTools = [
  {
    name: 'Navegaci√≥n combinada',
    description: 'Prueba con rat√≥n y teclado simult√°neamente',
  },
  {
    name: 'Simuladores de visi√≥n',
    description: 'NoCoffee, Stark para verificar contraste',
  },
  {
    name: 'DevTools',
    description: 'Inspecciona estados :hover y :focus juntos',
  },
  {
    name: 'Pruebas de usuario',
    description: 'Observa c√≥mo otros interpretan los estados',
  },
]
---

<Layout title="Estados Hover - a11yado">
  <article>
    <Header
      title="Estados Hover"
      description="Los estados hover mejoran la usabilidad para usuarios de rat√≥n, pero deben ser accesibles y consistentes con la navegaci√≥n por teclado para todos los usuarios."
    />

    <section>
      <h2>¬øSon esenciales los estados hover?</h2>
      <p>
        Seg√∫n WCAG, <strong
          >los estados hover no son t√©cnicamente obligatorios</strong
        >. Sin embargo, son una mejor pr√°ctica de usabilidad que beneficia a
        usuarios con rat√≥n cuando se implementan correctamente.
      </p>

      <BannerGrid columns="2" gap="lg">
        <Banner title="‚ùå No son obligatorios para WCAG" variant="info">
          <p>
            Si tu sitio no tiene estados hover, a√∫n puede pasar una auditor√≠a
            WCAG. No hay criterios espec√≠ficos que los requieran.
          </p>
        </Banner>

        <Banner title="‚úÖ S√≠ son mejores pr√°cticas" variant="good">
          <p>
            Mejoran la usabilidad para usuarios con rat√≥n y ayudan a identificar
            elementos interactivos de forma inmediata.
          </p>
        </Banner>
      </BannerGrid>

      <Banner
        title="ü§î Pregunta clave: ¬øSe benefician todos los usuarios?"
        variant="concept"
      >
        <p>
          Si dise√±as estados hover para <strong>algunos usuarios</strong>, debes
          asegurar que funcionen para <strong>todos los usuarios</strong> (sin discriminaci√≥n).
        </p>
        <p>
          <strong>Principio:</strong> Lo que mejora la experiencia para algunos,
          debe ser accesible para todos.
        </p>
      </Banner>
    </section>

    <section>
      <h2>Las 6 preguntas reveladoras</h2>
      <p>
        Estas preguntas te ayudan a determinar si tu dise√±o de estados hover es
        realmente accesible seg√∫n las mejores pr√°cticas.
      </p>

      <OrderedList>
        <OrderedListItem number={1} title="¬øEs este un estado esencial?">
          <p>
            Si nadie pudiera ver este estado, ¬øser√≠a perjudicial para la
            funcionalidad o comprensi√≥n del sitio?
          </p>
          <p>
            <strong>Evaluaci√≥n:</strong> Los hover states son "esenciales como mejor
            pr√°ctica" pero no t√©cnicamente requeridos por WCAG.
          </p>
        </OrderedListItem>

        <OrderedListItem number={2} title="¬øEs independiente del color?">
          <p>
            El estado no debe depender √∫nicamente del color para comunicar el
            cambio. Debe incluir cambios estructurales como borde, subrayado o
            forma.
          </p>
          <Banner title="üí° T√©cnicas recomendadas" variant="tip">
            <ul>
              <li>Cambio de color + borde adicional</li>
              <li>Cambio de color + subrayado</li>
              <li>Cambio de color + sombra</li>
              <li>Cambio de forma + color</li>
            </ul>
          </Banner>
        </OrderedListItem>

        <OrderedListItem number={3} title="¬øTiene suficiente contraste?">
          <p>
            Los elementos gr√°ficos del estado hover deben tener contraste 3:1
            contra colores adyacentes. El texto debe mantener contraste 4.5:1.
          </p>
        </OrderedListItem>

        <OrderedListItem number={4} title="¬øEs suficientemente visible?">
          <p>
            El cambio debe ser lo suficientemente grande para ser percibido.
            Para outlines: m√≠nimo 1px alrededor del per√≠metro.
          </p>
        </OrderedListItem>

        <OrderedListItem number={5} title="¬øUsa se√±alizadores apropiados?">
          <p>
            ¬øEl estado realmente parece "hover" o podr√≠a confundirse con otro
            estado? Los usuarios deben reconocer inmediatamente que el elemento
            es interactivo.
          </p>
        </OrderedListItem>

        <OrderedListItem number={6} title="¬øEs consistente con el foco?">
          <p>
            <strong>Mejor pr√°ctica:</strong> Los estados hover y focus deben ser
            visualmente consistentes para crear una experiencia unificada.
          </p>
        </OrderedListItem>
      </OrderedList>
    </section>

    <section>
      <h2>Ejemplos pr√°cticos comparativos</h2>

      <Banner title="üí° Tip de prueba" variant="tip">
        Usa tanto el rat√≥n (hover) como el teclado (Tab) para navegar y comparar
        si ambos estados se ven similares y apropiados.
      </Banner>

      <Banner title="‚úÖ Estado hover consistente con foco" variant="good">
        <div class="demo-container-white">
          <div class="demo-container">
            <div class="demo-buttons">
              <button class="demo-btn consistent-state"
                >Bot√≥n consistente</button
              >
              <input
                type="text"
                class="demo-input consistent-state"
                placeholder="Input consistente..."
              />
              <a href="#" class="demo-link consistent-state"
                >Enlace consistente</a
              >
            </div>
            <div class="demo-explanation">
              <p><strong>Por qu√© funciona:</strong></p>
              <ul>
                <li>Hover y focus usan el mismo outline negro de 2px</li>
                <li>Ambos estados son independientes del color</li>
                <li>El contraste es excelente en ambos casos</li>
                <li>Experiencia unificada para todos los usuarios</li>
              </ul>
            </div>
          </div>
        </div>
      </Banner>

      <Banner title="‚ùå Estados inconsistentes" variant="bad">
        <div class="demo-container-white">
          <div class="demo-container">
            <div class="demo-buttons">
              <button class="demo-btn inconsistent-hover"
                >Hover inconsistente</button
              >
              <input
                type="text"
                class="demo-input inconsistent-hover"
                placeholder="Input inconsistente..."
              />
              <a href="#" class="demo-link inconsistent-hover"
                >Enlace inconsistente</a
              >
            </div>
            <div class="demo-explanation">
              <p><strong>Por qu√© confunde:</strong></p>
              <ul>
                <li>Hover cambia color, focus usa outline</li>
                <li>Experiencias completamente diferentes</li>
                <li>Usuarios de teclado ven algo distinto</li>
                <li>Inconsistencia genera confusi√≥n</li>
              </ul>
            </div>
          </div>
        </div>
      </Banner>

      <Banner title="‚ùå Solo cambio de color" variant="bad">
        <div class="demo-container-white">
          <div class="demo-container">
            <div class="demo-buttons">
              <button class="demo-btn color-only-hover">Solo color</button>
              <input
                type="text"
                class="demo-input color-only-hover"
                placeholder="Solo cambio de color..."
              />
              <a href="#" class="demo-link color-only-hover">Solo color</a>
            </div>
            <div class="demo-explanation">
              <p><strong>Por qu√© falla:</strong></p>
              <ul>
                <li>Depende √∫nicamente del color para comunicar el estado</li>
                <li>Personas con daltonismo pueden no percibir el cambio</li>
                <li>
                  No cumple con <a
                    href="https://www.w3.org/WAI/WCAG22/Understanding/use-of-color.html"
                    target="_blank"
                    rel="noopener">WCAG 1.4.1 (Uso del Color)</a
                  >
                </li>
                <li>Falta se√±alizador estructural adicional</li>
              </ul>
            </div>
          </div>
        </div>
      </Banner>
    </section>

    <section>
      <h2>Contenido adicional en hover</h2>
      <p>
        Si tu estado hover muestra contenido adicional (tooltips, men√∫s), debe
        cumplir <a
          href="https://www.w3.org/WAI/WCAG22/Understanding/content-on-hover-or-focus.html"
          target="_blank"
          rel="noopener">WCAG 1.4.13</a
        >: ser desechable, hover-able y persistente.
      </p>

      <CardGrid columns="auto" minWidth="300px">
        <Card title="‚úÖ Tooltip accesible" variant="success" borderAccent>
          <div class="tooltip-demo">
            <button class="tooltip-btn accessible-tooltip"
              >Hover para tooltip accesible</button
            >
            <div class="tooltip-content">
              <p>Este tooltip se puede:</p>
              <ul>
                <li>Desechar con Escape</li>
                <li>Hacer hover sobre √©l</li>
                <li>Permanece visible</li>
              </ul>
            </div>
          </div>
        </Card>

        <Card title="‚ùå Tooltip problem√°tico" variant="danger" borderAccent>
          <div class="tooltip-demo">
            <button class="tooltip-btn problematic-tooltip"
              >Hover para tooltip problem√°tico</button
            >
            <div class="tooltip-content">
              <p>Este tooltip:</p>
              <ul>
                <li>Desaparece al mover el rat√≥n</li>
                <li>No se puede desechar con teclado</li>
                <li>No es hover-able</li>
              </ul>
            </div>
          </div>
        </Card>

        <Card title="üéØ Estados de cursor" variant="primary" borderAccent>
          <p>
            Los cambios de cursor (flecha ‚Üí mano) est√°n controlados por el
            navegador y est√°n exentos de requisitos de contraste WCAG.
          </p>
          <div class="cursor-demo">
            <button class="cursor-btn">Cambio de cursor nativo</button>
          </div>
        </Card>
      </CardGrid>
    </section>

    <section>
      <h2>Mejores pr√°cticas t√©cnicas</h2>

      <CardGrid columns="auto" minWidth="300px">
        <Card
          title="üíª CSS: :hover y :focus juntos"
          variant="primary"
          borderAccent
        >
          <p>
            Usa ambos pseudo-selectores para crear experiencias consistentes.
          </p>
          <div class="code-example">
            <pre><code>{`.button:hover, 
.button:focus {
  outline: 2px solid #000;
  outline-offset: 2px;
}`}
</code></pre>
          </div>
        </Card>

        <Card
          title="üé® Dise√±o: Se√±alizadores m√∫ltiples"
          variant="primary"
          borderAccent
        >
          <p>
            Combina cambios de color con cambios estructurales para mejor
            accesibilidad.
          </p>
          <div class="signifier-demo">
            <button class="multi-signifier-btn">Color + Borde + Sombra</button>
          </div>
        </Card>

        <Card
          title="‚å®Ô∏è Teclado: Funcionalidad equivalente"
          variant="primary"
          borderAccent
        >
          <p>
            Cualquier acci√≥n de hover debe tener un equivalente de teclado
            accesible.
          </p>
          <div class="keyboard-demo">
            <button class="keyboard-equivalent">Funciona con Tab y hover</button
            >
          </div>
        </Card>
      </CardGrid>
    </section>

    <Checklist
      title="‚úÖ Antes de publicar, verifica:"
      items={checklistItems}
      variant="success"
    />

    <ToolsSection title="Herramientas √∫tiles" tools={hoverTools}>
      <p>Para verificar la accesibilidad de tus estados hover:</p>

      <CardGrid columns="auto" minWidth="300px">
        <Card title="üîç Pruebas de contraste" variant="info" borderAccent>
          <ul>
            <li>
              <strong>Regla 3:1:</strong> Para elementos gr√°ficos (bordes, iconos)
            </li>
            <li><strong>Regla 4.5:1:</strong> Para texto en elementos</li>
            <li><strong>Prueba:</strong> Entre estados default y hover</li>
          </ul>
        </Card>

        <Card title="üë• Pruebas de usabilidad" variant="info" borderAccent>
          <ul>
            <li><strong>Pregunta:</strong> "¬øQu√© estado representa esto?"</li>
            <li><strong>Observa:</strong> Si reconocen interactividad</li>
            <li><strong>Valida:</strong> Consistencia entre hover y focus</li>
          </ul>
        </Card>
      </CardGrid>
    </ToolsSection>
  </article>
</Layout>

<style lang="scss">
  article {
    max-width: 90ch;
  }

  .demo-container-white {
    background-color: white;
    padding: var(--spacing-lg);
    border-radius: 6px;
    border: 1px solid var(--color-border);
  }

  .demo-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-xl);
    align-items: start;
  }

  .demo-buttons {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
  }

  .demo-btn {
    padding: var(--spacing-sm) var(--spacing-md);
    border: none;
    border-radius: 6px;
    font-weight: 500;
    cursor: pointer;
    background-color: var(--color-primary);
    color: white;
    transition: all 0.2s;
  }

  .demo-input {
    padding: var(--spacing-sm) var(--spacing-md);
    border: 1px solid var(--color-border);
    border-radius: 6px;
    font-size: 0.875rem;
  }

  .demo-link {
    color: var(--color-primary);
    text-decoration: underline;
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: 4px;
    display: inline-block;

    &:hover {
      background-color: var(--color-surface);
    }
  }

  /* Estados consistentes hover + focus */
  .consistent-state {
    &:hover,
    &:focus {
      outline: 2px solid #000;
      outline-offset: 2px;
    }
  }

  /* Estados inconsistentes */
  .inconsistent-hover {
    &:hover {
      background-color: #2563eb;
      transform: translateY(-1px);
    }

    &:focus {
      outline: 2px solid #dc2626;
      outline-offset: 1px;
    }
  }

  /* Solo cambio de color */
  .color-only-hover {
    &:hover {
      background-color: #16a34a;
    }

    &:focus {
      background-color: #16a34a;
    }
  }

  .demo-explanation {
    background-color: var(--color-background);
    padding: var(--spacing-md);
    border-radius: 6px;

    ul {
      margin: var(--spacing-sm) 0 0 0;
      padding-left: var(--spacing-lg);
    }

    li {
      margin-bottom: var(--spacing-xs);
      font-size: 0.875rem;
    }
  }

  /* Tooltip demos */
  .tooltip-demo {
    position: relative;
    margin-bottom: var(--spacing-md);
  }

  .tooltip-btn {
    background-color: var(--color-primary);
    color: white;
    border: none;
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: 6px;
    cursor: pointer;
    font-weight: 500;
  }

  .accessible-tooltip {
    &:hover + .tooltip-content,
    &:focus + .tooltip-content {
      display: block;
    }
  }

  .problematic-tooltip {
    &:hover + .tooltip-content {
      display: block;
    }
  }

  .tooltip-content {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 6px;
    padding: var(--spacing-sm);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    z-index: 10;
    min-width: 200px;
    margin-top: var(--spacing-xs);

    p {
      margin: 0 0 var(--spacing-xs) 0;
      font-size: 0.875rem;
    }

    ul {
      margin: 0;
      padding-left: var(--spacing-lg);
      font-size: 0.875rem;
    }

    li {
      margin-bottom: var(--spacing-xs);
    }
  }

  /* Cursor demo */
  .cursor-btn {
    background-color: var(--color-primary);
    color: white;
    border: none;
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: 6px;
    cursor: pointer;
    font-weight: 500;

    &:hover {
      background-color: #1e40af;
    }
  }

  /* Code example */
  .code-example {
    margin-top: var(--spacing-sm);

    pre {
      background-color: #f1f5f9;
      padding: var(--spacing-sm);
      border-radius: 4px;
      overflow-x: auto;
      font-size: 0.875rem;
      margin: 0;

      code {
        color: #374151;
        font-family: 'Courier New', monospace;
      }
    }
  }

  /* Multi-signifier demo */
  .multi-signifier-btn {
    background-color: var(--color-primary);
    color: white;
    border: none;
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: 6px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s;

    &:hover,
    &:focus {
      background-color: #1e40af;
      border: 2px solid #000;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
  }

  /* Keyboard equivalent demo */
  .keyboard-equivalent {
    background-color: var(--color-primary);
    color: white;
    border: none;
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: 6px;
    cursor: pointer;
    font-weight: 500;

    &:hover,
    &:focus {
      outline: 2px solid #000;
      outline-offset: 2px;
      background-color: #1e40af;
    }
  }

  .signifier-demo,
  .keyboard-demo {
    margin-top: var(--spacing-sm);
  }

  @media (max-width: 768px) {
    .demo-container {
      grid-template-columns: 1fr;
      gap: var(--spacing-lg);
    }
  }
</style>
